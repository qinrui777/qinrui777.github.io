<!DOCTYPE html>


  <html lang="en">
    

    <head>
      <meta charset="utf-8" />
        
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title> Hexo</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/palm-tree.ico" />
       <link rel="stylesheet" href="/dist/main.css">
      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css"
      />
      <link rel="stylesheet" href="/css/custom.css"> 
      <script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
       
 

      <!-- mermaid -->
      
    </head>
  </html>
</html>


<body>
  <div id="app">
    
      
    <main class="content on">
      
<section class="cover">
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="/images/cover2.jpg" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/">Hexo</a></h1>
      <div id="subtitle-box">
        
        <span id="subtitle"></span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>



<script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js"></script>


<!-- Subtitle -->

  <script>
    try {
      var typed = new Typed("#subtitle", {
        strings: ['一笑皆春', '', ''],
        startDelay: 0,
        typeSpeed: 200,
        loop: true,
        backSpeed: 100,
        showCursor: true
      });
    } catch (err) {
      console.log(err)
    }
  </script>
  
<div id="main">
  <section class="outer">
  
  
  <article class="articles">
    
    
    
    
    <article
  id="post-Openshift-E04-Image-Stream是个啥"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/01/31/Openshift-E04-Image-Stream是个啥/"
    >Openshift E04 Image Stream是个啥</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2021/01/31/Openshift-E04-Image-Stream是个啥/" class="article-date">
  <time datetime="2021-01-31T05:23:35.000Z" itemprop="datePublished">2021-01-31</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/CICD/">CICD</a>
  </div>
 
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>Image Stream(中文名  镜像流) 是一组镜像的集合, OpenShift默认情况下提供了几个Image Streams，包括许多流行的runtime和frameworks。</p>
<p>Image Streams tag(中文名 镜像流标签对象)是指向Image Streams中的image的别名。通常缩写为istag。它包含一个image历史记录，表示为tag曾经指向的所有images的堆栈。</p>
<p>(??? image stream就是类似repo的概念)</p>
<p>一个镜像流标签对象（ImageStreamTag）指向一个镜像，可以是本地镜像或者远程镜像。如下的名为“python”的镜像流包含两个标签，标签34指向Python v3.4镜像，标签35指向Pythonv3.5镜像。</p>
<p>导入Image Stream<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Method 1</span></span><br><span class="line">oc create -f xxx.yaml -n openshift</span><br><span class="line"></span><br><span class="line"><span class="comment"># Method 2</span></span><br><span class="line">oc import-image</span><br></pre></td></tr></table></figure></p>
<p>查看Image Stream<br><code>oc get is -n openshift</code></p>
<p>查看Image Stream Tag</p>
<p><code>oc get istag</code></p>
<p>例子</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">docker pull ericnie2017/s2i-tomcat:latest</span><br><span class="line"></span><br><span class="line">oc import-image ericnie2017/s2i-tomcat -n openshift --confirm --insecure</span><br><span class="line"></span><br><span class="line">oc get is -n openshift | grep tomcat</span><br></pre></td></tr></table></figure>
<p>Service Catalog 中看到的不能与 <code>oc get is</code>  的结果一一对应，只能部分对应。</p>
<p> <a href="https://www.zhihu.com/column/p/31637802" target="_blank" rel="noopener">知乎-Service Catalog及OpenShift的历史</a></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OpenShift/">OpenShift</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-Openshift-E03-谈谈S2I"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/01/31/Openshift-E03-谈谈S2I/"
    >Openshift E03 谈谈S2I</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2021/01/31/Openshift-E03-谈谈S2I/" class="article-date">
  <time datetime="2021-01-31T04:27:01.000Z" itemprop="datePublished">2021-01-31</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/CICD/">CICD</a>
  </div>
 
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>  关于OpenShift，至今为止还没有梳理核心组件和概念上的解释，但似乎并不太妨碍初步的简单使用。而 Source to Image(S2I) 是OpenShift 的一个重要功能，也是其的一大特色。</p>
<h3 id="What"><a href="#What" class="headerlink" title="What"></a>What</h3><h5 id="第一：从OpenShift的角度来看"><a href="#第一：从OpenShift的角度来看" class="headerlink" title="第一：从OpenShift的角度来看"></a>第一：从OpenShift的角度来看</h5><p>  Source to Image(S2I) 是OopenShift中应用容器化的 <strong>标准流程</strong>。</p>
<h5 id="第二：-从自身工具的属性来看"><a href="#第二：-从自身工具的属性来看" class="headerlink" title="第二： 从自身工具的属性来看"></a>第二： 从自身工具的属性来看</h5><p>  Source-to-Image (S2I) 是一种用于构建可重复生成的 Docker 格式容器镜像的工具。</p>
<h3 id="How"><a href="#How" class="headerlink" title="How"></a>How</h3><p>S2I 需要的最基本的输入只有两个： 一个是源代码仓库(Source Code)；另一个是Builder Image（也称“构建镜像、Builder镜像”、基础镜像、构建器）</p>
<p>从应用的源代码构建并部署，Openshift通过一个S2I的构建过程编译打包并实现发布，具体可以参考<a href="https://www.cnblogs.com/ericnie/p/9677719.html" target="_blank" rel="noopener">这篇文章</a></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># install s2i tool on MacOS</span></span><br><span class="line">brew install <span class="built_in">source</span>-to-image</span><br><span class="line"></span><br><span class="line"><span class="comment"># s2i create &lt;image name&gt; &lt;destination directory&gt;</span></span><br><span class="line">s2i create s2i-tomcat s2i-tomcat</span><br><span class="line"></span><br><span class="line"><span class="comment"># get dir ,file </span></span><br><span class="line">➜  s2i-tomcat tree</span><br><span class="line">.</span><br><span class="line">├── Dockerfile</span><br><span class="line">├── Makefile</span><br><span class="line">├── README.md</span><br><span class="line">├── s2i</span><br><span class="line">│   └── bin</span><br><span class="line">│       ├── assemble</span><br><span class="line">│       ├── run</span><br><span class="line">│       ├── save-artifacts</span><br><span class="line">│       └── usage</span><br><span class="line">└── <span class="built_in">test</span></span><br><span class="line">    ├── run</span><br><span class="line">    └── <span class="built_in">test</span>-app</span><br><span class="line">        └── index.html</span><br><span class="line"></span><br><span class="line">4 directories, 9 files</span><br></pre></td></tr></table></figure>
<p><a href="https://www.cnblogs.com/ericnie/p/9677719.html" target="_blank" rel="noopener">S2I tomcat 镜像定制案例</a>，源码可见 <a href="https://github.com/cicd-draft/s2i-tomcat" target="_blank" rel="noopener">https://github.com/cicd-draft/s2i-tomcat</a></p>
<h3 id="OpenShift的构建"><a href="#OpenShift的构建" class="headerlink" title="OpenShift的构建"></a>OpenShift的构建</h3><p>OpenShift支持4种构建方式：Docker构建、S2I构建、Pipeline构建和自定义构建。详情可见<a href="https://access.redhat.com/documentation/zh-cn/openshift_container_platform/4.2/html-single/builds/index#builds-about_understanding-image-builds" target="_blank" rel="noopener">官方说明</a></p>
<ul>
<li><p>Docker构建会调用docker build命令，基于所提供的Dockerfile文件和所提供的内容来构建Docker镜像。</p>
</li>
<li><p>S2I构建是OpenShift的原创，它根据指定的构建镜像（Builder Image）和源代码（Source Code），构建生成可部署Docker镜像，并推送到OpenShift内部集成镜像库中。</p>
</li>
<li><p>Pipeline构建方式允许开发者定义Jenkins Pipeline。在项目首次使用该构建方式时，OpenShift容器云平台会启动一个Jenkins服务，然后再将该Pipeline交由它来执行，并负责启动、监控和管理该构建。BuildConfig对象中可以直接包含Jenkins Pipeline的内容，或者包含其Git仓库地址。</p>
</li>
</ul>
<hr>
<ul>
<li><a href="https://github.com/openshift/source-to-image/blob/master/docs/cli.md" target="_blank" rel="noopener">s2i cli usage</a></li>
<li><a href="https://www.cnblogs.com/ericnie/p/9677719.html" target="_blank" rel="noopener">S2I tomcat 镜像定制</a></li>
<li><a href="https://www.ewhisper.cn/binary-builds-with-openshift.html" target="_blank" rel="noopener">使用OpenShift进行二进制构建</a></li>
</ul>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OpenShift/">OpenShift</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-Openshift-E02-部署Jenkins服务"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/01/10/Openshift-E02-部署Jenkins服务/"
    >Openshift E02 部署Jenkins服务</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2021/01/10/Openshift-E02-部署Jenkins服务/" class="article-date">
  <time datetime="2021-01-10T08:02:03.000Z" itemprop="datePublished">2021-01-10</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/CICD/">CICD</a>
  </div>
 
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>OpenShift 项目默认提供了两个Jenkins部署模板, Jenkins-ephemeral 和 Jenkins-persistent</p>
<ul>
<li><p><strong>Jenkins-ephemeral</strong> 模板部署的Jenkins服务的数据在容器退出后将丢失，适合测试使用；</p>
</li>
<li><p><strong>Jenkins-persistent</strong> 模板部署需要持久化卷的支持，其部署的Jenkins 服务的数据可以被持久化。</p>
</li>
</ul>
<blockquote>
<p> 这里有很多官方的案例源码： <a href="https://github.com/openshift/origin/tree/v1.3.0/examples" target="_blank" rel="noopener">https://github.com/openshift/origin/tree/v1.3.0/examples</a></p>
</blockquote>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">oc login -u developer https://192.168.99.109:8443</span><br><span class="line"></span><br><span class="line"><span class="comment"># create a new project, name: ci</span></span><br><span class="line">oc new-project ci</span><br><span class="line"></span><br><span class="line"><span class="comment"># Create a template, </span></span><br><span class="line">oc create -f https://raw.githubusercontent.com/openshift/origin/v1.3.0/examples/jenkins/jenkins-ephemeral-template.json </span><br><span class="line"></span><br><span class="line"><span class="comment"># Get template</span></span><br><span class="line">oc get template</span><br><span class="line">NAME                DESCRIPTION                                       PARAMETERS        OBJECTS</span><br><span class="line">jenkins-ephemeral   Jenkins service, without persistent storage....   6 (1 generated)   6</span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">➜  ~ oc policy add-role-to-user edit -z default</span><br><span class="line">role <span class="string">"edit"</span> added: <span class="string">"default"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">➜  ~ oc new-app --template=jenkins-ephemeral --param=JENKINS_PASSWORD=welcome123</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">--&gt; Deploying template &quot;ci/jenkins-ephemeral&quot; to project ci</span><br><span class="line"></span><br><span class="line">     jenkins-ephemeral</span><br><span class="line">     ---------</span><br><span class="line">     Jenkins service, without persistent storage.</span><br><span class="line">     WARNING: Any data stored will be lost upon pod destruction. Only use this template for testing</span><br><span class="line"></span><br><span class="line">     A Jenkins service has been created in your project.  The username/password are admin/welcome.  The tutorial at https://github.com/openshift/origin/blob/master/examples/jenkins/README.md contains more information about using this template.</span><br><span class="line"></span><br><span class="line">     * With parameters:</span><br><span class="line">        * Jenkins Service Name=jenkins</span><br><span class="line">        * Jenkins JNLP Service Name=jenkins-jnlp</span><br><span class="line">        * Jenkins Password=welcome</span><br><span class="line">        * Memory Limit=512Mi</span><br><span class="line">        * Jenkins ImageStream Namespace=openshift</span><br><span class="line">        * Jenkins ImageStreamTag=jenkins:latest</span><br><span class="line"></span><br><span class="line">--&gt; Creating resources ...</span><br><span class="line">    route.route.openshift.io &quot;jenkins&quot; created</span><br><span class="line">    deploymentconfig.apps.openshift.io &quot;jenkins&quot; created</span><br><span class="line">    serviceaccount &quot;jenkins&quot; created</span><br><span class="line">    rolebinding.authorization.openshift.io &quot;jenkins_edit&quot; created</span><br><span class="line">    service &quot;jenkins-jnlp&quot; created</span><br><span class="line">    service &quot;jenkins&quot; created</span><br><span class="line">--&gt; Success</span><br><span class="line">    Access your application via route &apos;jenkins-ci.192.168.99.109.nip.io&apos;</span><br><span class="line">    Run &apos;oc status&apos; to view your app.</span><br></pre></td></tr></table></figure>
<p>部署失败了，💔</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">oc delete all -l app=jenkins-ephemeral</span><br><span class="line">pod <span class="string">"jenkins-1-6k7s6"</span> deleted</span><br><span class="line">replicationcontroller <span class="string">"jenkins-1"</span> deleted</span><br><span class="line">service <span class="string">"jenkins"</span> deleted</span><br><span class="line">service <span class="string">"jenkins-jnlp"</span> deleted</span><br><span class="line">deploymentconfig.apps.openshift.io <span class="string">"jenkins"</span> deleted</span><br><span class="line">route.route.openshift.io <span class="string">"jenkins"</span> deleted</span><br></pre></td></tr></table></figure>
<p>不能删除 serviceaccounts<br><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">oc delete serviceaccounts -l app=jenkins-ephemeral</span><br><span class="line">oc delete rolebindings.authorization.openshift.io jenkins_edit</span><br></pre></td></tr></table></figure></p>
<p>删除干净后，可以用命令 <code>oc get all -o wide</code> 验证</p>
<p>再来一次 </p>
<p><code>oc new-app --template=jenkins-ephemeral --param=JENKINS_PASSWORD=welcome123</code></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OpenShift/">OpenShift</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-Openshift-E01-最常见的使用场景"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2021/01/10/Openshift-E01-最常见的使用场景/"
    >Openshift E01 最常见的使用场景</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2021/01/10/Openshift-E01-最常见的使用场景/" class="article-date">
  <time datetime="2021-01-10T07:35:25.000Z" itemprop="datePublished">2021-01-10</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/CICD/">CICD</a>
  </div>
 
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>暂时不介绍 openshift 的概念，也不介绍如何安装、部署，先使用一个例子来看看 openshift 能做什么。</p>
<h3 id="新建一个项目"><a href="#新建一个项目" class="headerlink" title="新建一个项目"></a>新建一个项目</h3><p>在我的本地，使用developer/developer登陆 OpenShift控制台,右上角点击 <code>+Create Project</code></p>
<ul>
<li>Name -&gt; <code>mybank</code></li>
<li>Display Name -&gt; <code>MyBank</code></li>
<li>Description- &gt; <code>MyBank Application</code></li>
</ul>
<p>新建之后，去到 <code>MyBank</code> project, <code>Overview</code>, <code>Browse Catalog</code>  <code>Wildfly</code>；补充如下截图的信息</p>
<p><a href="https://imgchr.com/i/slR7a4" target="_blank" rel="noopener"><img src="https://s3.ax1x.com/2021/01/10/slR7a4.png" alt="slR7a4.png"></a></p>
<p>Application github repo url: <a href="https://github.com/nichochen/mybank-demo-maven" target="_blank" rel="noopener">https://github.com/nichochen/mybank-demo-maven</a></p>
<p>点击 <code>Create</code> 按钮后，OpenShift就会创建一系列的后台对象，进而出发S2I流程。构建的过程需要连接互联网下载应用的源代码、Maven构建所需要的Jar包以及镜像。在我的电脑上clone后大概等待了20min，然后才继续后面的步骤。</p>
<p><a href="https://imgchr.com/i/slIrq0" target="_blank" rel="noopener"><img src="https://s3.ax1x.com/2021/01/10/slIrq0.png" alt="slIrq0.png"></a></p>
<p>我本地使用minishift搭建的OpenShift实验环境</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># login vm</span></span><br><span class="line">minishift ssh</span><br><span class="line"></span><br><span class="line"><span class="comment"># grep the image</span></span><br><span class="line">[docker@minishift ~]<span class="variable">$docker</span> images | grep bank</span><br><span class="line">172.30.1.1:5000/mybank/mybank                            latest              9f9a257dce21        8 minutes ago       961 MB</span><br></pre></td></tr></table></figure>
<p>一切便都结束了，不要太省心～<br><a href="https://imgchr.com/i/slTjbt" target="_blank" rel="noopener"><img src="https://s3.ax1x.com/2021/01/10/slTjbt.png" alt="slTjbt.png"></a></p>
<p>可以直接从浏览器访问应用程序了<br><a href="https://imgchr.com/i/sl7ZV0" target="_blank" rel="noopener"><img src="https://s3.ax1x.com/2021/01/10/sl7ZV0.png" alt="sl7ZV0.png"></a></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OpenShift/">OpenShift</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-Excel常用函数"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/12/24/Excel常用函数/"
    >Excel常用函数</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2020/12/24/Excel常用函数/" class="article-date">
  <time datetime="2020-12-24T04:40:07.000Z" itemprop="datePublished">2020-12-24</time>
</a>  
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>查找一一对应的关系</p>
<p><code>=VLOOKUP(F1,configs!$D:$E,2,0)</code>   $用来保持D E不动</p>
<p><code>=VLOOKUP(B9,configs!A:B,2,0)</code></p>
<p><code>=MID(K2,1,1)</code>  从第一位开始，取1位</p>
<p><code>=MID(K2,1,3)</code>  从第一位开始，取3位</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Tools/">Tools</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-Validate-a-Jenkinsfile"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/12/18/Validate-a-Jenkinsfile/"
    >Validate a Jenkinsfile </a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2020/12/18/Validate-a-Jenkinsfile/" class="article-date">
  <time datetime="2020-12-18T08:54:20.000Z" itemprop="datePublished">2020-12-18</time>
</a>  
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>总是在运行jenkins pipeline时，才发现语法问题。能不能在运行前发现问题呢</p>
<h3 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h3><p>方法之一如下，更多方法可参考链接</p>
<p>新建一个文件，JenkinsfileA，添加以下正确的内容</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">pipeline &#123;</span><br><span class="line">    agent any</span><br><span class="line">    environment &#123;</span><br><span class="line">        MY_ENV = <span class="string">'my-test'</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    stages &#123;</span><br><span class="line">        stage(<span class="string">"Open the door"</span>) &#123;</span><br><span class="line">            steps &#123;</span><br><span class="line">                echo <span class="string">'Open the door ..'</span></span><br><span class="line">                bat <span class="string">label:</span> <span class="string">''</span>, <span class="string">script:</span> <span class="string">'chdir'</span></span><br><span class="line">                bat <span class="string">label:</span> <span class="string">''</span>, <span class="string">script:</span> <span class="string">'set'</span></span><br><span class="line">                powershell <span class="string">label:</span> <span class="string">''</span>, <span class="string">script:</span> <span class="string">"echo $&#123;MY_ENV&#125;"</span></span><br><span class="line">                powershell <span class="string">label:</span> <span class="string">''</span>, <span class="string">script:</span> <span class="string">"echo \\name\\folder"</span></span><br><span class="line">                powershell <span class="string">label:</span> <span class="string">''</span>, <span class="string">script:</span> <span class="string">"echo //123//565"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p>在文件所在的目录，运行下面的命令<br><code>curl --user admin:admin -X POST -F &quot;jenkinsfile=&lt;JenkinsfileA&quot; http://localhost:8080/pipeline-model-converter/validate</code></p>
<p>送上原文的链接 <a href="https://sandrocirulli.net/how-to-validate-a-jenkinsfile/" target="_blank" rel="noopener">https://sandrocirulli.net/how-to-validate-a-jenkinsfile/</a></p>
<p><code>curl --user username:password -X POST -F &quot;jenkinsfile=&lt;Jenkinsfile&quot; http://jenkins-url:8080/pipeline-model-converter/validate</code></p>
<p><strong> &lt; （尖括号）一定要，不然有问题</strong></p>
<p>Note the following:</p>
<p>If your Jenkins is authenticating users, you need to pass the username and password otherwise you can omit that part.<br>By default, this command expects your Jenkinsfile to be called Jenkinsfile. If not, change the name in the command.<br>Replace jenkins_url and possibly port 8080 based on the URL and port where you are running Jenkins. You can also use localhost as URL if you are running Jenkins on your machine.</p>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>VS Code 的插件也很不错 <a href="https://www.jenkins.io/blog/2018/11/07/Validate-Jenkinsfile/" target="_blank" rel="noopener">https://www.jenkins.io/blog/2018/11/07/Validate-Jenkinsfile/</a> ，但如果本地没有安装 VS Code 就还是用其他方法吧</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jenkins/">jenkins</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-Jenkins-FAQ"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/11/12/Jenkins-FAQ/"
    >Jenkins Error</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2020/11/12/Jenkins-FAQ/" class="article-date">
  <time datetime="2020-11-12T09:30:18.000Z" itemprop="datePublished">2020-11-12</time>
</a>  
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h3 id="中文乱码问题"><a href="#中文乱码问题" class="headerlink" title="中文乱码问题"></a>中文乱码问题</h3><p>参考<br><a href="https://www.cnblogs.com/unknows/p/8519636.html" target="_blank" rel="noopener">https://www.cnblogs.com/unknows/p/8519636.html</a></p>
<p><a href="http://yeshaoting.github.io/article/jenkins/jenkins%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81%E4%B8%8E%E6%9C%8D%E5%8A%A1%E5%90%AF%E5%8A%A8/" target="_blank" rel="noopener">http://yeshaoting.github.io/article/jenkins/jenkins%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81%E4%B8%8E%E6%9C%8D%E5%8A%A1%E5%90%AF%E5%8A%A8/</a></p>
<h3 id="Jenkins-console-output-display-color"><a href="#Jenkins-console-output-display-color" class="headerlink" title="Jenkins console output display color"></a>Jenkins console output display color</h3><p>打印测试报告时jenkins console output输出如下：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&gt; Task :cucumber</span><br><span class="line"></span><br><span class="line">Scenario: ????         [90m<span class="comment"># src/test/resources/features/bta_open_an_account.feature:3[0m</span></span><br><span class="line">Starting MSEdgeDriver 85.0.564.51 (626274a16bb350129a74ead7a3d8d53a5ad39364) on port 5325</span><br><span class="line">Only <span class="built_in">local</span> connections are allowed.</span><br><span class="line">Please see https://chromedriver.chromium.org/security-considerations <span class="keyword">for</span> suggestions on keeping MSEdgeDriver safe.</span><br><span class="line">MSEdgeDriver was started successfully.</span><br><span class="line">[1605165549.451][WARNING]: This version of MSEdgeDriver has not been tested with MSEdge version 86.</span><br><span class="line">Nov 12, 2020 3:19:11 PM org.openqa.selenium.remote.ProtocolHandshake createSession</span><br><span class="line">INFO: Detected dialect: W3C</span><br><span class="line">http://10.20.159.131:8080/ifmmanage/bizframe/loginnew.jsp</span><br><span class="line">  [32mGiven [0m[32m??BTA???????[0m   [90m<span class="comment"># steps.StepDefs.login()[0m</span></span><br><span class="line">  [32mAnd [0m[32m??BTA?????[0m       [90m<span class="comment"># steps.StepDefs.assertLoginSuccess()[0m</span></span><br><span class="line">  [32mWhen [0m[32m??[0m[32m[1m<span class="string">"????"</span>[0m[32m???[0m     [90m<span class="comment"># steps.StepDefs.open_tab(java.lang.String)[0m</span></span><br><span class="line">  [32mAnd [0m[32m???????[0m[32m[1m<span class="string">"????"</span>[0m[32m??[0m  [90m<span class="comment"># steps.StepDefs.clickClearingSystem(java.lang.String)[0m</span></span><br><span class="line">  [32mAnd [0m[32m????????[0m         [90m<span class="comment"># steps.StepDefs.clickDailyStartClearing()[0m</span></span><br><span class="line">  [32mAnd [0m[32m??????[0m           [90m<span class="comment"># steps.StepDefs.confirmWindow()[0m</span></span><br><span class="line">  [32mThen [0m[32m???????[0m[32m[1m<span class="string">"????"</span>[0m[32m??[0m [90m<span class="comment"># steps.StepDefs.clickClearingSystem(java.lang.String)[0m</span></span><br></pre></td></tr></table></figure></p>
<p>ref: <a href="https://www.programmersought.com/article/66361313580/" target="_blank" rel="noopener">https://www.programmersought.com/article/66361313580/</a></p>
<h3 id="How-to-stop-an-unstoppable-zombie-job-on-Jenkins-without-restarting-the-server"><a href="#How-to-stop-an-unstoppable-zombie-job-on-Jenkins-without-restarting-the-server" class="headerlink" title="How to stop an unstoppable zombie job on Jenkins without restarting the server?"></a>How to stop an unstoppable zombie job on Jenkins without restarting the server?</h3><p>Go to “Manage Jenkins” &gt; “Script Console” and run a script:</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Jenkins .instance.getItemByFullName(<span class="string">"JobName"</span>)</span><br><span class="line">        .getBuildByNumber(JobNumber)</span><br><span class="line">        .finish(hudson.model.Result.ABORTED, <span class="keyword">new</span> java.io.IOException(<span class="string">"Aborting build"</span>));</span><br></pre></td></tr></table></figure>
<p>You’ll have just specify your JobName and JobNumber.</p>
<p>ref: <a href="https://stackoverflow.com/questions/14456592/how-to-stop-an-unstoppable-zombie-job-on-jenkins-without-restarting-the-server" target="_blank" rel="noopener">https://stackoverflow.com/questions/14456592/how-to-stop-an-unstoppable-zombie-job-on-jenkins-without-restarting-the-server</a></p>
<h3 id="jenkins-的在slave-node运行的-job-状态不更新"><a href="#jenkins-的在slave-node运行的-job-状态不更新" class="headerlink" title="jenkins 的在slave node运行的 job 状态不更新"></a>jenkins 的在slave node运行的 job 状态不更新</h3><p>jenkins master： Windows PC<br>jenkins slave: linux server</p>
<p>某个调度到slave的运行job总是不更新状态，明明已经完成了任务，但一直在页面左下角显示的是在运行中</p>
<p>可尝试 <a href="https://kb.iu.edu/d/aopy" target="_blank" rel="noopener">https://kb.iu.edu/d/aopy</a></p>
<h3 id="引号"><a href="#引号" class="headerlink" title="引号"></a>引号</h3><p>// 单引号需要拼接 容易出错 不推荐使用<br><code>sh &#39;mkdir -p &#39; + VARIABLE</code><br>// 三引号支持变量等内容，引号嵌套等 推荐使用<br><code>sh &quot;&quot;&quot;cp ${VARIABLE}/ &#39;abc&#39; &quot;123&quot; ${VARIABLE_1}/${VARIABLE_2}&quot;&quot;&quot;</code></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/jenkins/">jenkins</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-IntelliJ-与-Gradle版本不兼容"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/11/06/IntelliJ-与-Gradle版本不兼容/"
    >IntelliJ 与 Gradle版本不兼容</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2020/11/06/IntelliJ-与-Gradle版本不兼容/" class="article-date">
  <time datetime="2020-11-06T02:25:07.000Z" itemprop="datePublished">2020-11-06</time>
</a>  
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>IntelliJ version: 2018.2.7 CE</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">IntelliJ IDEA 2018.2.7 (Community Edition)</span><br><span class="line">Build <span class="comment">#IC-182.5107.41, built on November 27, 2018</span></span><br><span class="line">JRE: 1.8.0_152-release-1248-b22 amd64</span><br><span class="line">JVM: OpenJDK 64-Bit Server VM by JetBrains s.r.o</span><br><span class="line">Windows 10 10.0</span><br></pre></td></tr></table></figure>
<p>Gradle version 6.1.1</p>
<p>报错截图如下：</p>
<p><img src="/images/intellij_error.png" alt="error"></p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">java.lang.NoClassDefFoundError: org/gradle/api/internal/plugins/DefaultConvention</span><br><span class="line">	at org.jetbrains.plugins.gradle.tooling.builder.ProjectExtensionsDataBuilderImpl.buildAll(ProjectExtensionsDataBuilderImpl.groovy:50)</span><br><span class="line">	at org.jetbrains.plugins.gradle.tooling.internal.ExtraModelBuilder.buildAll(ExtraModelBuilder.java:67)</span><br><span class="line">	at org.gradle.tooling.provider.model.internal.DefaultToolingModelBuilderRegistry<span class="variable">$BuildOperationWrappingToolingModelBuilder</span><span class="variable">$1</span><span class="variable">$1</span>.create(DefaultToolingModelBuilderRegistry.java:104)</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h3 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h3><p><strong>step1</strong></p>
<p><img src="/images/Intellij-step1.png" alt="step11"></p>
<p><strong>step2</strong></p>
<p><img src="/images/intellij-step2.png" alt="step2"></p>
<p>大致原因就是版本不匹配，都是时间从中作祟。</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Tools/">Tools</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-谈系列-谈家2020"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/09/17/谈系列-谈家2020/"
    >谈系列-谈家2020</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2020/09/17/谈系列-谈家2020/" class="article-date">
  <time datetime="2020-09-17T07:12:02.000Z" itemprop="datePublished">2020-09-17</time>
</a>  
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  Here's something encrypted, password is required to continue reading. 
      <a class="article-more-link" href="/2020/09/17/谈系列-谈家2020/"
        >阅读更多...</a
      >
       
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Q-List/">Q List</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
    <article
  id="post-出行清单"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2020/08/28/出行清单/"
    >出行清单</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2020/08/28/出行清单/" class="article-date">
  <time datetime="2020-08-28T08:37:50.000Z" itemprop="datePublished">2020-08-28</time>
</a>  
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>良久的蛰伏后，迎来一次出差的机会，时隔近2年吧。小时候梦想着能走出去，多坐坐火车、飞机、轮船等等，长大后实现了，发现并不那么美好。</p>
<h3 id="1-夏季-短期-出差"><a href="#1-夏季-短期-出差" class="headerlink" title="1.夏季-短期-出差"></a>1.夏季-短期-出差</h3><blockquote>
<p>1个月以内的，衣物数量包括自己身上穿的那一套</p>
</blockquote>
<p>短袖3件以上<br>内裤3件<br>长裤2件<br>袜子3件<br>证件、卡照（身份证，驾照，银行卡）<br>毛巾<br>充电线（手机的，手表的）<br>洗漱包（牙刷，不用电动牙刷）<br>水杯<br>纸巾2包<br>人字拖<br>书2本<br>耳机<br>电脑 及 充电线</p>
<p>特产</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Q-List/">Q List</a></li></ul>

    </footer>
  </div>

    
 
    
</article>

    
  </article>
  

  
  <nav class="page-nav">
    
    <a class="extend prev" rel="prev" href="/">上一页</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/12/">12</a><a class="extend next" rel="next" href="/page/3/">下一页</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2019-2021
        <i class="ri-heart-fill heart_icon"></i> John Doe
      </li>
    </ul>
    <ul>
      <li>
        
        
        
        Powered by <a href="https://hexo.io" target="_blank">Hexo</a>
        <span class="division">|</span>
        Theme - <a href="https://github.com/Shen-Yu/hexo-theme-ayer" target="_blank">Ayer</a>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>Visitors:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>Views:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/images/palm-tree.svg" alt="Hexo"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/2020/03/16/about">关于我</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    
  </div>
</div>
    <script src="/js/jquery-2.0.3.min.js"></script> <script src="/js/lazyload.min.js"></script>
<!-- Tocbot -->

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>
<script src="/dist/main.js"></script>
<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 <script src="/js/busuanzi-2.3.pure.min.js"></script> 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 <link rel="stylesheet" href="/css/clipboard.css"> <script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
  </div>
</body>

</html>